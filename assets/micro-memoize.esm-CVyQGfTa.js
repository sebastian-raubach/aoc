var E={isEqual:!0,isMatchingKey:!0,isPromise:!0,maxSize:!0,onCacheAdd:!0,onCacheChange:!0,onCacheHit:!0,transformKey:!0},H=Array.prototype.slice;function d(t){var e=t.length;return e?e===1?[t[0]]:e===2?[t[0],t[1]]:e===3?[t[0],t[1],t[2]]:H.call(t,0):[]}function F(t){var e={};for(var n in t)E[n]||(e[n]=t[n]);return e}function M(t){return typeof t=="function"&&t.isMemoized}function k(t,e){return t===e||t!==t&&e!==e}function O(t,e){var n={};for(var r in t)n[r]=t[r];for(var r in e)n[r]=e[r];return n}var q=function(){function t(e){this.keys=[],this.values=[],this.options=e;var n=typeof e.isMatchingKey=="function";n?this.getKeyIndex=this._getKeyIndexFromMatchingKey:e.maxSize>1?this.getKeyIndex=this._getKeyIndexForMany:this.getKeyIndex=this._getKeyIndexForSingle,this.canTransformKey=typeof e.transformKey=="function",this.shouldCloneArguments=this.canTransformKey||n,this.shouldUpdateOnAdd=typeof e.onCacheAdd=="function",this.shouldUpdateOnChange=typeof e.onCacheChange=="function",this.shouldUpdateOnHit=typeof e.onCacheHit=="function"}return Object.defineProperty(t.prototype,"size",{get:function(){return this.keys.length},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"snapshot",{get:function(){return{keys:d(this.keys),size:this.size,values:d(this.values)}},enumerable:!1,configurable:!0}),t.prototype._getKeyIndexFromMatchingKey=function(e){var n=this.options,r=n.isMatchingKey,u=n.maxSize,i=this.keys,a=i.length;if(!a)return-1;if(r(i[0],e))return 0;if(u>1){for(var s=1;s<a;s++)if(r(i[s],e))return s}return-1},t.prototype._getKeyIndexForMany=function(e){var n=this.options.isEqual,r=this.keys,u=r.length;if(!u)return-1;if(u===1)return this._getKeyIndexForSingle(e);var i=e.length,a,s;if(i>1){for(var o=0;o<u;o++)if(a=r[o],a.length===i){for(s=0;s<i&&n(a[s],e[s]);s++);if(s===i)return o}}else for(var o=0;o<u;o++)if(a=r[o],a.length===i&&n(a[0],e[0]))return o;return-1},t.prototype._getKeyIndexForSingle=function(e){var n=this.keys;if(!n.length)return-1;var r=n[0],u=r.length;if(e.length!==u)return-1;var i=this.options.isEqual;if(u>1){for(var a=0;a<u;a++)if(!i(r[a],e[a]))return-1;return 0}return i(r[0],e[0])?0:-1},t.prototype.orderByLru=function(e,n,r){for(var u=this.keys,i=this.values,a=u.length,s=r;s--;)u[s+1]=u[s],i[s+1]=i[s];u[0]=e,i[0]=n;var o=this.options.maxSize;a===o&&r===a?(u.pop(),i.pop()):r>=o&&(u.length=i.length=o)},t.prototype.updateAsyncCache=function(e){var n=this,r=this.options,u=r.onCacheChange,i=r.onCacheHit,a=this.keys[0],s=this.values[0];this.values[0]=s.then(function(o){return n.shouldUpdateOnHit&&i(n,n.options,e),n.shouldUpdateOnChange&&u(n,n.options,e),o},function(o){var l=n.getKeyIndex(a);throw l!==-1&&(n.keys.splice(l,1),n.values.splice(l,1)),o})},t}();function P(t,e){if(e===void 0&&(e={}),M(t))return P(t.fn,O(t.options,e));if(typeof t!="function")throw new TypeError("You must pass a function to `memoize`.");var n=e.isEqual,r=n===void 0?k:n,u=e.isMatchingKey,i=e.isPromise,a=i===void 0?!1:i,s=e.maxSize,o=s===void 0?1:s,l=e.onCacheAdd,v=e.onCacheChange,p=e.onCacheHit,C=e.transformKey,c=O({isEqual:r,isMatchingKey:u,isPromise:a,maxSize:o,onCacheAdd:l,onCacheChange:v,onCacheHit:p,transformKey:C},F(e)),h=new q(c),m=h.keys,K=h.values,A=h.canTransformKey,z=h.shouldCloneArguments,S=h.shouldUpdateOnAdd,x=h.shouldUpdateOnChange,_=h.shouldUpdateOnHit,f=function(){var y=z?d(arguments):arguments;A&&(y=C(y));var g=m.length?h.getKeyIndex(y):-1;if(g!==-1)_&&p(h,c,f),g&&(h.orderByLru(m[g],K[g],g),x&&v(h,c,f));else{var I=t.apply(this,arguments),U=z?y:d(arguments);h.orderByLru(U,I,m.length),a&&h.updateAsyncCache(f),S&&l(h,c,f),x&&v(h,c,f)}return K[0]};return f.cache=h,f.fn=t,f.isMemoized=!0,f.options=c,f}export{P as c};
