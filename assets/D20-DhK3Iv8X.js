import{c as C,V as R}from"./color-Cgs3GWPp.js";import{a4 as O,v as D,o as S,c as N,a as W,r as F,w as P,ab as T,a6 as G,ah as X,a0 as Y}from"./index-CRldfuY8.js";import{_ as j}from"./_plugin-vue_export-helper-DlAUqK2U.js";const q={id:"holderOne",class:"canvas-holder"},z=O({__name:"V20",props:{width:{},height:{},path:{},walls:{},sOne:{}},setup(v){const p=v,x=()=>{var f;const t=Math.max(1,Math.floor((((f=document.getElementById("holderOne"))==null?void 0:f.offsetWidth)||1)/p.width)),r=document.getElementById("partOne"),e=r.getContext("2d");r.width=p.width*t+1,r.height=p.height*t+1,e.translate(.5,.5),e.lineWidth=1,e.fillStyle="#222222",e.strokeStyle="white",e.fillRect(0,0,r.width,r.height),e.fillStyle="#2f3542",p.walls.forEach(a=>{const[y,c]=a.split("|").map(Number);e.fillRect(y*t,c*t,t,t)});const w=C(R,p.path.length+1);p.path.forEach((a,y)=>{e.fillStyle=w[y],e.fillRect(a.x*t,a.y*t,t,t)}),p.sOne.forEach(a=>{const y=a.path[0].x+.5,c=a.path[1].x+.5,u=a.path[0].y+.5,h=a.path[1].y+.5;e.beginPath(),e.moveTo(y*t,u*t),e.lineTo(c*t,h*t);const $=Math.sign(a.path[0].x-a.path[1].x),g=Math.sign(a.path[0].y-a.path[1].y);g===0?(e.lineTo((c+.5*$)*t,(h-.5)*t),e.moveTo(c*t,h*t),e.lineTo((c+.5*$)*t,(h+.5)*t)):$===0&&(e.lineTo((c-.5)*t,(h+.5*g)*t),e.moveTo(c*t,h*t),e.lineTo((c+.5)*t,(h+.5*g)*t)),e.stroke()})};return D(()=>x()),(t,r)=>(S(),N("div",q,r[0]||(r[0]=[W("canvas",{id:"partOne",class:"canvas",height:"500",width:"500"},null,-1)])))}}),A=j(z,[["__scopeId","data-v-4d0ba1b8"]]),Q=O({__name:"D20",props:{input:{}},emits:["onFinished"],setup(v,{emit:p}){const x=v,t=p,r=F(!1);let e=0,w=0;const f=[],a=[];let y=0;const c={x:0,y:0},u={x:0,y:0},h=new Set,$=[[-1,0],[1,0],[0,1],[0,-1]],g=[[-2,0],[2,0],[0,2],[0,-2]],b=()=>{const d=new Set;let o=c;for(;o.x!==u.x||o.y!==u.y;){f.push(o),d.add(`${o.x}|${o.y}`);const s=$.map(n=>({x:o.x+n[0],y:o.y+n[1]})).find(n=>n.x>=0&&n.x<e&&n.y>=0&&n.y<w&&!h.has(`${n.x}|${n.y}`)&&!d.has(`${n.x}|${n.y}`));s&&(o=s)}return f.push(u),f},k=d=>{const o=f.map(s=>`${s.x}|${s.y}`);f.forEach((s,n)=>{g.forEach(i=>{const l=`${s.x+i[0]}|${s.y+i[1]}`,m=`${s.x+i[0]/2}|${s.y+i[1]/2}`,_=o.indexOf(l);_>n&&_-n-2>=d&&h.has(m)&&a.push({path:[s,{x:s.x+i[0],y:s.y+i[1]}]})})})},B=(d,o)=>{const s=new Map;f.forEach((n,i)=>s.set(`${n.x}|${n.y}`,i)),f.forEach((n,i)=>{for(let l=-o;l<=o;l++)for(let m=-o+Math.abs(l);m<=o-Math.abs(l);m++){const _=`${n.x+m}|${n.y+l}`,E=s.get(_)||-1,M=Math.abs(m)+Math.abs(l),V=E-i-M;M<=o&&E>i&&V>=d&&y++}})},I=()=>{if(x.input){w=x.input.length,x.input.forEach((s,n)=>{e===0&&(e=s.length),s.split("").forEach((i,l)=>{i==="#"?h.add(`${l}|${n}`):i==="S"?(c.x=l,c.y=n):i==="E"&&(u.x=l,u.y=n)})}),b(),k(100),B(100,20);const d=a.length;t("onFinished",d,y),Y(()=>{r.value=!0})}};return P(()=>x.input,()=>I(),{immediate:!0}),(d,o)=>T(r)?(S(),G(A,{key:0,height:T(w),path:f,"s-one":a,walls:T(h),width:T(e)},null,8,["height","walls","width"])):X("",!0)}});export{Q as default};
